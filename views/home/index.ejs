<aside class="filters">
  <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        Filters
        </button>
        <div class="dropdown-menu filter-menu" aria-labelledby="dropdownMenuButton">
        <form class="form" method="POST" action="/">

          <h6>Locations</h6>
          <% locationFilter.forEach(function(locationFilter) { %> 
          <label><%=locationFilter%></label>
          <input type="checkbox" name="loc" class="loc" checked value="<%=locationFilter%>">
          <% }) %>
          <hr>

          <h6>Months</h6>          
          <% monthFilter.forEach(function(monthFilter) { %> 
          <label><%=monthFilter%></label>
          <input type="checkbox" name="month" class="month" checked value="<%=monthFilter%>">
          <% }) %>

          <hr>
          
          <h6>Artists</h6>
          <% artistFilter.forEach(function(artistFilter) { %> 
          <label><%=artistFilter%></label>
          <input type="checkbox" name="art" class="art" checked value="<%=artistFilter%>">
          <% }) %>

          <hr>

          <h6>Genres</h6>          
          <% genreFilter.forEach(function(genreFilter) { %> 
          <label><%=genreFilter%></label>
          <input type="checkbox" name="gen" class="gen" checked value="<%=genreFilter%>">
          <% }) %>

          <hr>

          <button type="submit" class="btn btn-primary select">select</button>
        </form>
      </div>
  </div>
  <div class="register">Insert something about registering as a user</div>

    </aside> 
        

        
        

        <div class="event-body">
          <!-- -------------------------------------------------------------------- -->
       
            <div class="event-grid">
              <!-- NEARLY THERE -->

              <% if (location == 0 && month == 0 && artist == 0 && genre == 0) { %>
              <% event.forEach(function(event) { %>
                <div class="event">
                  <div><h4><%=event.name %></h4></div>
                  
                  <img class="event-image" src="../image/<%=event.eventPhoto%>">
                  
                  <div><b><%=event.city %> - <span><%= new Date(event.date).toLocaleDateString('en-us', { year:"numeric", month:"short", day:"numeric"})%></span></b></div>
                  
                  <div class="artists-info">
                    <div class="artists">
                      <% for (i = 0; i < event.artist.length; i++){ %>
                      <h5 class="artist"><%=event.artist[i].bandName %></h5>
                      <% } %>
                    </div>
                    
                    <div class="genres">
                      <% for (i = 0; i < event.artist.length; i++){ %>
                      <h6><%=event.artist[i].genres %></h6>
                      <% } %> 
                    </div>
                 </div>
            
                <form method="POST" action="/auth/bookmarks"  class="bookmark">
                  <input type="hidden" name="id" value="<%= event._id %>"/>
                  <input type="submit" value="add" class="bookmark green"/>
                  </form>
                </div> 

              <% })} else { %>

              <% event.forEach(function(event) { %>  
                <% let artistgenres = "" %>
                <% let artistMatch = true %>
                <% let genreMatch = true %>
                <% let artistgenresArr = [] %>

                <% for (i = 0; i < event.artist.length; i++){ %>
                <% if (artist.includes(event.artist[i].bandName) == false) { %>
                <% artistMatch = false; %>
                <% }} %>

                <% for (i = 0; i < event.artist.length; i++){ %>
                <% artistgenres += event.artist[i].genres %>
                <% } %>
  
                <% artistgenreArr = JSON.stringify(artistgenres).split(",") %>
                <% trimmedGenre = artistgenreArr[0].replace('"', '') %>
                <% trimmedGenre2 = artistgenreArr[artistgenreArr.length -1].replace('"', '') %>
                <% artistgenreArr.splice(0,1); %>
                <% artistgenreArr.splice(artistgenreArr.length-1, 1) %>
                <% artistgenreArr.push(trimmedGenre) %>
                <% artistgenreArr.push(trimmedGenre2) %>
                <% console.log(artistgenreArr) %>
                 

                <% for(i = 0; i < artistgenreArr.length; i++) { %>
                <% console.log(artistgenreArr[i] + " " + genre) %>
                <% if(genre.indexOf(artistgenreArr[i]) <= -1) { %>
                <% genreMatch = false}%>
                <% } %>
     

                <% if(location.indexOf(event.city) != -1 && month.indexOf(event.month) != -1 && artistMatch == true && genreMatch == true) { %>

                <!-- INCLUDE IF STATEMENT HERE -->
              <div class="event">
                <div><h4><%=event.name %></h4></div>
                
                <img class="event-image" src="../image/<%=event.eventPhoto%>">
                
                <div><b><%=event.city %> - <span><%= new Date(event.date).toLocaleDateString('en-us', { year:"numeric", month:"short", day:"numeric"})%></span></b></div>
                
                <div class="artists-info">
                  <div class="artists">
                    <% for (i = 0; i < event.artist.length; i++){ %>
                    <h5 class="artist"><%=event.artist[i].bandName %></h5>
                    <% } %>
                  </div>
                  
                  <div class="genres">
                    <% for (i = 0; i < event.artist.length; i++){ %>
                    <h6><%=event.artist[i].genres %></h6>
                    <% } %> 
                  </div>
                </div>
                <form method="POST" action="/auth/bookmarks" class="bookmark">
                  <input type="hidden" name="id" value="<%= event._id %>"/>
                  <input type="submit" value="add" class="bookmark green"/>
                  </form>
              </div>
              <% } %>
              <% }) %>

              <% } %>

            <!-- -------------------------------------------------------------------- -->
          </div> 
        </div>


